#!/usr/bin/env bash
set -e

source "$FASRCSW_DEV/setup.sh"  #(bash arrays cannot be exported, so get them this way)
fasrcsw-env-check

for comp in "${FASRCSW_COMPS[@]}"; do
	IFS=/ read -r comp_fam comp_verrel <<< "$comp"
	IFS=- read -r comp_ver comp_rel    <<< "$comp_verrel"
	
	echo
	echo
	echo "fasrcsw: building an rpm"
	echo

	set -x
	fasrcsw-rpmbuild-Core \
		--define "comp_fam $comp_fam" --define "comp_ver $comp_ver" --define "comp_rel $comp_rel" \
		"$@"
	set +x
done
